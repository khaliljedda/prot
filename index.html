<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>prot.tn - Protein House</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            position: relative;
        }

        .language-selector {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            gap: 10px;
            background: white;
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .lang-btn {
            padding: 8px 15px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .lang-btn:hover {
            border-color: #000;
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: #000;
            color: white;
            border-color: #000;
        }

        header h1 {
            font-size: 3.5em;
            font-weight: 300;
            letter-spacing: 8px;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: #000;
        }

        header p {
            font-size: 1.2em;
            font-weight: 300;
            color: #666;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .meal-summary {
            background: white;
            border-radius: 20px;
            padding: 35px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.4);
            position: sticky;
            top: 20px;
            height: fit-content;
            transform: scale(1.02);
            z-index: 10;
        }

        .meal-photo-container {
            width: 100%;
            min-height: 280px;
            background: linear-gradient(145deg, #2c2c2c 0%, #1a1a1a 100%);
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            overflow: auto;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }

        .meal-photo {
            width: 260px;
            height: 260px;
            background: radial-gradient(circle, #ffffff 0%, #f5f5f5 60%, #e0e0e0 100%);
            border-radius: 50%;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            align-items: center;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3), inset 0 2px 5px rgba(255,255,255,0.5);
            position: relative;
            border: 8px solid #e8e8e8;
        }

        .meal-photo::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 15px;
            right: 15px;
            bottom: 15px;
            border-radius: 50%;
            border: 1px solid rgba(200,200,200,0.3);
        }

        .meal-ingredient-icon {
            font-size: 2.2em;
            animation: popIn 0.3s ease;
            transition: transform 0.2s ease;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
            position: relative;
            z-index: 1;
        }

        .meal-ingredient-icon:hover {
            transform: scale(1.15) rotate(-5deg);
            filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
        }

        @keyframes popIn {
            0% {
                transform: scale(0) rotate(-180deg);
                opacity: 0;
            }
            60% {
                transform: scale(1.15) rotate(10deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .empty-meal-placeholder {
            font-size: 3em;
            color: #ccc;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
        }

        .empty-state-message {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .empty-state-message h3 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .empty-state-message p {
            font-size: 0.9em;
            line-height: 1.6;
        }

        .meal-items-count {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 0.9em;
            color: #666;
        }

        .meal-items-count strong {
            color: #000;
            font-size: 1.2em;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .progress-bars {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .progress-item {
            margin-bottom: 15px;
        }

        .progress-item:last-child {
            margin-bottom: 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .progress-bar-container {
            width: 100%;
            height: 12px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.4s ease, background 0.4s ease;
            position: relative;
        }

        .progress-bar-fill.protein-bar {
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
        }

        .progress-bar-fill.calorie-bar {
            background: linear-gradient(90deg, #f87171, #ef4444);
        }

        .progress-bar-fill.weight-bar {
            background: linear-gradient(90deg, #60a5fa, #3b82f6);
        }

        .mobile-sticky-bar {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px 20px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            border-top: 2px solid #e0e0e0;
        }

        .mobile-sticky-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        .mobile-price {
            font-size: 1.5em;
            font-weight: bold;
        }

        .mobile-protein {
            font-size: 0.9em;
            color: #666;
        }

        .mobile-protein strong {
            color: #000;
            font-size: 1.2em;
        }

        .mobile-cta {
            padding: 12px 20px;
            background: #000;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .price-display {
            background: #000;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        .price-display .label {
            font-size: 1em;
            color: #fff;
            margin-bottom: 5px;
            font-weight: 300;
        }

        .price-display .value {
            font-size: 3em;
            font-weight: bold;
            color: white;
        }

        .macro-highlights {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .macro-card {
            background: #fff;
            border: 2px solid #e0e0e0;
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            color: #333;
            transition: all 0.3s ease;
        }

        .macro-card.protein {
            background: linear-gradient(135deg, #fff5e6 0%, #ffffff 100%);
            border-color: #ffd699;
        }

        .macro-card.calories {
            background: linear-gradient(135deg, #ffe6e6 0%, #ffffff 100%);
            border-color: #ffb3b3;
        }

        .macro-card .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .macro-card .value {
            font-size: 2.3em;
            font-weight: bold;
            color: #000;
        }

        .other-macros {
            background: #fff;
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .other-macros h3 {
            font-size: 0.9em;
            color: #000;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .macro-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .macro-row:last-child {
            border-bottom: none;
        }

        .meal-quantity {
            margin-bottom: 20px;
        }

        .meal-quantity label {
            display: block;
            margin-bottom: 15px;
            font-weight: 600;
            color: #333;
            text-align: center;
        }

        .meal-quantity-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }

        .meal-quantity-btn {
            width: 50px;
            height: 50px;
            border: 2px solid #000;
            border-radius: 50%;
            background: #fff;
            color: #000;
            font-size: 1.8em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .meal-quantity-btn:hover {
            background: #000;
            color: #fff;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .meal-quantity-btn:active {
            transform: scale(0.95);
        }

        .meal-quantity-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            background: #fff;
            color: #000;
        }

        .meal-quantity-btn.add-feedback {
            animation: addGlow 0.4s ease;
        }

        .meal-quantity-display {
            font-size: 2.5em;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
            color: #000;
            background: #fff;
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        .cart-section {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .cart-header h3 {
            font-size: 1.2em;
            font-weight: 600;
            color: #000;
            margin: 0;
        }

        .cart-badge {
            background: #000;
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            font-weight: bold;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .cart-item-info {
            flex: 1;
            margin-right: 15px;
        }

        .cart-item-name {
            font-weight: 600;
            color: #000;
            margin-bottom: 5px;
            font-size: 1em;
        }

        .cart-item-details {
            font-size: 0.85em;
            color: #666;
            line-height: 1.5;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-item-price {
            font-weight: bold;
            color: #000;
            min-width: 70px;
            text-align: right;
            font-size: 1.1em;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #000;
            color: white;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .empty-cart {
            text-align: center;
            padding: 30px;
            color: #999;
        }

        .cart-remove-btn {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 6px 12px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cart-remove-btn:hover {
            background: #dc2626;
        }

        .action-buttons {
            display: grid;
            gap: 10px;
        }

        .btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #000;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #333;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #fff;
            color: #000;
            border: 2px solid #000;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #f5f5f5;
            transform: translateY(-2px);
        }

        .btn-clear {
            background: #fff;
            color: #666;
            border: 2px solid #e0e0e0;
            font-size: 0.9em;
            padding: 10px;
        }

        .btn-clear:hover {
            background: #fff;
            color: #000;
            border-color: #000;
        }

        .builder-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            opacity: 0.95;
        }

        .quick-meals-section {
            margin-bottom: 30px;
        }

        .quick-meals-section h2 {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #000;
            font-weight: 300;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .quick-meals-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .quick-meal-card {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .quick-meal-card:hover {
            border-color: #000;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .quick-meal-card h3 {
            font-size: 1.3em;
            margin-bottom: 12px;
            color: #000;
            font-weight: 600;
        }

        .quick-meal-card .meal-description {
            font-size: 0.9em;
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
            flex: 1;
        }

        .quick-meal-card .meal-nutrition {
            font-size: 0.85em;
            color: #333;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .quick-meal-card .meal-nutrition strong {
            color: #000;
        }

        .ingredients-section h2 {
            font-size: 1.8em;
            margin-bottom: 25px;
            color: #000;
            font-weight: 300;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }

        .ingredient-category {
            margin-bottom: 35px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .category-title {
            font-size: 1.4em;
            color: #000;
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 15px;
            border-bottom: 2px solid #dee2e6;
        }

        .ingredient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .ingredient-card {
            background: #fff;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .ingredient-card:hover {
            border-color: #000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .ingredient-card.highlight {
            animation: highlightPulse 0.5s ease;
        }

        @keyframes highlightPulse {
            0%, 100% {
                background: #fff;
                transform: scale(1);
            }
            50% {
                background: #f0f0f0;
                transform: scale(1.02);
            }
        }

        .ingredient-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
        }

        .ingredient-header {
            padding: 15px;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
        }

        .ingredient-title-section {
            flex: 1;
        }

        .ingredient-icon {
            font-size: 3.5em;
        }

        .ingredient-name {
            font-weight: 600;
            font-size: 1.2em;
            color: #000;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ingredient-unit {
            font-size: 0.9em;
            color: #666;
        }

        .info-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f0f0f0;
            border: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            color: #666;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .info-icon:hover {
            background: #000;
            color: #fff;
            border-color: #000;
        }

        .ingredient-nutrition {
            background: #fff;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9em;
            line-height: 1.8;
            color: #333;
        }

        .ingredient-nutrition-compact {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 15px;
            font-size: 0.85em;
        }

        .ingredient-nutrition-compact.show {
            display: grid;
        }

        .nutrition-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nutrition-item strong {
            font-weight: 600;
            color: #000;
        }

        .info-toggle {
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .info-toggle:hover {
            background: #000;
            color: #fff;
        }

        .full-nutrition {
            display: none;
            font-size: 0.8em;
            color: #666;
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .full-nutrition.show {
            display: block;
        }

        .ingredient-card-footer {
            padding: 15px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
        }

        .ingredient-price-display {
            font-size: 1.3em;
            font-weight: bold;
            color: #000;
        }

        .ingredient-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-btn {
            width: 42px;
            height: 42px;
            border: 2px solid #000;
            border-radius: 50%;
            background: #fff;
            color: #000;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .control-btn:hover {
            background: #000;
            color: #fff;
            transform: scale(1.15);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .control-btn.add-feedback {
            animation: addGlow 0.4s ease;
        }

        .control-btn.remove-feedback {
            animation: removeGlow 0.4s ease;
        }

        @keyframes addGlow {
            0%, 100% {
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            50% {
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.8);
                background: #22c55e;
                color: white;
                border-color: #22c55e;
            }
        }

        @keyframes removeGlow {
            0%, 100% {
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            50% {
                box-shadow: 0 0 20px rgba(239, 68, 68, 0.8);
                background: #ef4444;
                color: white;
                border-color: #ef4444;
            }
        }

        .quantity-display {
            font-size: 1.5em;
            font-weight: bold;
            min-width: 50px;
            text-align: center;
            color: #000;
            background: #f8f9fa;
            padding: 5px 10px;
            border-radius: 8px;
        }

        .quantity-input {
            width: 50px;
            padding: 5px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
        }

        .ingredient-price {
            font-size: 1.1em;
            color: #fff;
            font-weight: 700;
            margin-top: 8px;
            text-align: center;
            background: #000;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .free-item {
            background: #fff;
            border: 2px solid #e0e0e0;
            padding: 20px;
            border-radius: 10px;
            color: #333;
            margin-top: 20px;
            text-align: center;
        }

        .free-item h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #000;
        }

        .free-item p {
            font-size: 0.95em;
            color: #666;
            line-height: 1.6;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .meal-summary {
                position: relative;
                top: 0;
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .language-selector {
                position: relative;
                margin: 0 auto 20px;
            }

            .lang-btn {
                padding: 6px 12px;
                font-size: 0.85em;
            }

            header h1 {
                font-size: 2em;
                letter-spacing: 4px;
            }

            .meals-grid {
                grid-template-columns: 1fr;
            }

            .quick-meals-grid {
                grid-template-columns: 1fr;
            }

            .macro-highlights {
                grid-template-columns: 1fr;
            }

            .ingredient-grid {
                grid-template-columns: 1fr;
            }

            .meal-photo-container {
                min-height: 180px;
            }

            .meal-photo {
                width: 200px;
                height: 200px;
            }

            .control-btn {
                width: 45px;
                height: 45px;
                font-size: 1.4em;
            }

            .mobile-sticky-bar {
                display: block;
            }

            body {
                padding-bottom: 90px;
            }

            .main-content {
                grid-template-columns: 1fr;
            }

            .meal-summary {
                transform: scale(1);
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .modal-content p {
            margin-bottom: 30px;
            color: #666;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector">
                <button class="lang-btn" onclick="changeLanguage('en')" id="lang-en">üá¨üáß EN</button>
                <button class="lang-btn" onclick="changeLanguage('fr')" id="lang-fr">üá´üá∑ FR</button>
                <button class="lang-btn active" onclick="changeLanguage('ar')" id="lang-ar">üáπüá≥ AR</button>
            </div>
            <h1>prot.tn</h1>
            <p id="header-subtitle">Premium Protein House - Build Your Perfect Meal</p>
        </header>

        <div class="main-content">
            <div class="builder-section">
                <div class="quick-meals-section">
                    <h2 data-translate="quickMeals">üéØ Quick Select Meals</h2>
                    <div class="quick-meals-grid">
                        <div class="quick-meal-card" onclick="selectQuickMeal('scalope')">
                            <h3 data-translate="mealScalope">Escalope Meal</h3>
                            <div class="meal-description">
                                <strong>100g Rice + 100g Escalope + Salad</strong>
                            </div>
                            <div class="meal-nutrition">
                                üí™ <strong>32g</strong> Protein | üî• <strong>495</strong> kcal | üí∞ <strong>13.00</strong> TND
                            </div>
                        </div>
                        <div class="quick-meal-card" onclick="selectQuickMeal('proteinOverdose')">
                            <h3 data-translate="mealProteinOverdose">Protein Overdose</h3>
                            <div class="meal-description">
                                <strong>100g Escalope + 1 Cuisse + 1 Egg + 1 Omelette + 1 Salad</strong>
                            </div>
                            <div class="meal-nutrition">
                                üí™ <strong>65g</strong> Protein | üî• <strong>555</strong> kcal | üí∞ <strong>16.80</strong> TND
                            </div>
                        </div>
                        <div class="quick-meal-card" onclick="selectQuickMeal('balanced')">
                            <h3 data-translate="mealBalanced">Balanced Meal</h3>
                            <div class="meal-description">
                                <strong>100g Rice + 100g Escalope + 2 Eggs + 1 Salad</strong>
                            </div>
                            <div class="meal-nutrition">
                                üí™ <strong>44g</strong> Protein | üî• <strong>635</strong> kcal | üí∞ <strong>14.60</strong> TND
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ingredients-section">
                    <h2 data-translate="buildOwn">üî® Build Your Own Meal</h2>

                    <div class="ingredient-category">
                        <div class="category-title" data-translate="carbs">üçö Carbs</div>
                        <div class="ingredient-grid">
                            <div class="ingredient-card">
                                <img src="rice.jpeg" alt="Rice" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="rice">Rice <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">50g <span data-translate="perUnit">per unit</span></div>pe
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>3g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>40g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>175</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>1.50 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">1.50 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('rice', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-rice">0</div>
                                        <button class="control-btn" onclick="updateIngredient('rice', 1)">+</button>
                                    </div>
                                </div>
                            </div>

                            <div class="ingredient-card">
                                <img src="borghol.jpg" alt="Borghol" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="borghol">Borghol <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">50g <span data-translate="perUnit">per unit</span></div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>4g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>38g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>170</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>1.50 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">1.50 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('borghol', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-borghol">0</div>
                                        <button class="control-btn" onclick="updateIngredient('borghol', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="ingredient-category">
                        <div class="category-title" data-translate="proteins">üçñ Proteins</div>
                        <div class="ingredient-grid">
                            <div class="ingredient-card">
                                <img src="escalope.jpg" alt="Escalope" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="escalope">Escalope <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">100g <span data-translate="perUnit">per unit</span></div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>25g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>0g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>120</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>8.50 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">8.50 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('scallop', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-scallop">0</div>
                                        <button class="control-btn" onclick="updateIngredient('scallop', 1)">+</button>
                                    </div>
                                </div>
                            </div>

                            <div class="ingredient-card">
                                <img src="cuisse.jpeg" alt="Cuisse" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="cuisse">Cuisse (Chicken Thigh) <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">1 <span data-translate="piece">piece</span></div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>18g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>0g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>160</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>3.50 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">3.50 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('cuisse', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-cuisse">0</div>
                                        <button class="control-btn" onclick="updateIngredient('cuisse', 1)">+</button>
                                    </div>
                                </div>
                            </div>

                            <div class="ingredient-card">
                                <img src="egg.jpeg" alt="Eggs" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="eggs">Eggs <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">1 <span data-translate="piece">piece</span></div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>6g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>1g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>70</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>0.80 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">0.80 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('eggs', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-eggs">0</div>
                                        <button class="control-btn" onclick="updateIngredient('eggs', 1)">+</button>
                                    </div>
                                </div>
                            </div>

                            <div class="ingredient-card">
                                <img src="omelette.jpeg" alt="Omelette" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="omelette">Omelette <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">1 <span data-translate="piece">piece</span> (<span data-translate="eggs3">3 eggs</span>)</div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>15g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>2g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>180</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>2.50 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">2.50 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('omelette', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-omelette">0</div>
                                        <button class="control-btn" onclick="updateIngredient('omelette', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="ingredient-category">
                        <div class="category-title" data-translate="salads">ü•ó Salads</div>
                        <div class="ingredient-grid">
                            <div class="ingredient-card">
                                <img src="salade.jpg" alt="Normal Salad" class="ingredient-image">
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name" data-ingredient="normalSalad">Normal Salad <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit">100g <span data-translate="perPortion">per portion</span></div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="proteinLabel">Protein</span>
                                        <strong>1g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>5g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>25</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="priceLabel">Price</span>
                                        <strong>1.50 TND</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display">1.50 TND</div>
                                    <div class="ingredient-controls">
                                        <button class="control-btn" onclick="updateIngredient('salad', -1)">‚àí</button>
                                        <div class="quantity-display" id="qty-salad">0</div>
                                        <button class="control-btn" onclick="updateIngredient('salad', 1)">+</button>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="ingredient-category">
                        <div class="category-title">üéÅ <span data-translate="freeFruit">Free Daily Surprise Fruit</span></div>
                        <div class="ingredient-grid">
                            <div class="ingredient-card">
                                <div style="width: 100%; height: 180px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); display: flex; align-items: center; justify-content: center; font-size: 5em;" id="surpriseFruitIcon">üéÅ</div>
                                <div class="ingredient-header">
                                    <div class="ingredient-title-section">
                                        <div class="ingredient-name"><span data-translate="surpriseFruit">Surprise Fruit</span> <span class="info-icon" onclick="toggleNutrition(this)">‚ÑπÔ∏è</span></div>
                                        <div class="ingredient-unit" data-translate="dailyFree">Daily free gift</div>
                                    </div>
                                </div>
                                <div class="ingredient-nutrition-compact">
                                    <div class="nutrition-item">
                                        <span data-translate="carbsLabel">Carbs</span>
                                        <strong>15g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span data-translate="caloriesLabel">Calories</span>
                                        <strong>80</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span>Fiber</span>
                                        <strong>4g</strong>
                                    </div>
                                    <div class="nutrition-item">
                                        <span>Vitamin C</span>
                                        <strong>High</strong>
                                    </div>
                                </div>
                                <div class="ingredient-card-footer">
                                    <div class="ingredient-price-display" style="color: #22c55e; font-weight: bold;">FREE</div>
                                    <div class="ingredient-controls" style="opacity: 0.5; pointer-events: none;">
                                        <div style="width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;">‚úì</div>
                                        <div class="quantity-display" style="color: #22c55e;">1</div>
                                        <div style="width: 42px; height: 42px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="meal-summary">
                <div class="meal-photo-container">
                    <div class="meal-photo" id="mealEmoji">üçΩÔ∏è</div>
                </div>

                <div class="price-display">
                    <div class="label" data-translate="totalPrice">Total Price</div>
                    <div class="value"><span id="totalPrice">0.00</span> TND</div>
                </div>

                <div class="macro-highlights">
                    <div class="macro-card protein">
                        <div class="label" data-translate="protein">üí™ Protein</div>
                        <div class="value"><span id="totalProtein">0</span>g</div>
                    </div>
                    <div class="macro-card calories">
                        <div class="label" data-translate="calories">üî• Calories</div>
                        <div class="value"><span id="totalCalories">0</span></div>
                    </div>
                </div>


                <div class="other-macros">
                    <h3 data-translate="nutritionalDetails">Nutritional Details</h3>
                    <div class="macro-row">
                        <span data-translate="carbohydrates">Carbohydrates</span>
                        <strong><span id="totalCarbs">0</span>g</strong>
                    </div>
                    <div class="macro-row">
                        <span data-translate="fats">Fats</span>
                        <strong><span id="totalFats">0</span>g</strong>
                    </div>
                    <div class="macro-row">
                        <span data-translate="fiber">Fiber (from fruit)</span>
                        <strong><span id="totalFiber">4</span>g</strong>
                    </div>
                </div>

                <div class="meal-items-count" id="itemsCount">
                    <strong>0</strong> items in your meal
                </div>

                <div class="meal-quantity">
                    <label data-translate="numberOfMeals">Number of Meals</label>
                    <div class="meal-quantity-controls">
                        <button class="meal-quantity-btn" onclick="changeMealCount(-1)" id="mealCountDecrease">‚àí</button>
                        <div class="meal-quantity-display" id="mealCountDisplay">1</div>
                        <button class="meal-quantity-btn" onclick="changeMealCount(1)" id="mealCountIncrease">+</button>
                    </div>
                    <input type="hidden" id="mealCount" value="1" min="1" max="7">
                </div>

                <div class="cart-section" id="cartSection" style="display: none;">
                    <div class="cart-header">
                        <h3 data-translate="cart">Cart</h3>
                        <div class="cart-badge" id="cartBadge">0</div>
                    </div>
                    <div id="cartItems"></div>
                    <div class="cart-total">
                        <span data-translate="total">Total:</span>
                        <span id="cartTotal">0.00 TND</span>
                    </div>
                    <div class="action-buttons" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="buyAllFromCart()" id="buyAllBtn" disabled data-translate="buyAll">üõí Buy All</button>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="addToCartBtn" onclick="addToCart()" disabled data-translate="addToCart">‚ûï Add to Cart</button>
                    <button class="btn btn-secondary" id="saveBtn" onclick="saveMeal()" disabled data-translate="saveMeal">üíæ Save Meal</button>
                    <button class="btn btn-clear" onclick="clearMeal()" data-translate="clearAll">üóëÔ∏è Clear All</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="successModal">
        <div class="modal-content">
            <h2>‚úÖ Success!</h2>
            <p id="modalMessage">Your action was successful!</p>
            <button class="btn btn-primary" onclick="closeModal()">Close</button>
        </div>
    </div>

    <div class="modal" id="customerInfoModal">
        <div class="modal-content">
            <h2 data-translate="customerInfo">Customer Information</h2>
            <form id="customerForm" onsubmit="submitOrder(event)">
                <div style="margin-bottom: 20px; text-align: left;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600;" data-translate="yourName">Your Name</label>
                    <input type="text" id="customerName" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em;">
                </div>
                <div style="margin-bottom: 20px; text-align: left;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600;" data-translate="yourPhone">Your Phone Number</label>
                    <input type="tel" id="customerPhone" required pattern="[0-9]{8}" maxlength="8" placeholder="12345678" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em;" oninput="validatePhone(this)" onkeypress="return /[0-9]/.test(event.key)">
                    <small id="phoneError" style="color: #ef4444; display: none; margin-top: 5px; font-size: 0.85em;" data-translate="phoneError">Phone number must be exactly 8 digits</small>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;" data-translate="confirmOrder2">Confirm Order</button>
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeCustomerModal()" data-translate="cancel">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div class="mobile-sticky-bar" id="mobileBar">
        <div class="mobile-sticky-content">
            <div>
                <div class="mobile-price"><span id="mobileTotalPrice">0.00</span> TND</div>
                <div class="mobile-protein">üí™ <strong id="mobileTotalProtein">0</strong>g Protein</div>
            </div>
            <button class="mobile-cta" onclick="scrollToSummary()" data-translate="viewMeal">View Meal</button>
        </div>
    </div>

    <script>
        // Translation System
        let currentLanguage = 'ar';
        
        const translations = {
            en: {
                headerSubtitle: "Premium Protein House - Build Your Perfect Meal",
                quickMeals: "Quick Select Meals",
                mealScalope: "Escalope Meal",
                mealProteinOverdose: "Protein Overdose",
                mealBalanced: "Balanced Meal",
                buildOwn: "Build Your Own Meal",
                proteins: "Proteins",
                carbs: "Carbs",
                salads: "Salads",
                escalope: "Escalope",
                cuisse: "Chicken Thigh",
                eggs: "Eggs",
                omelette: "Omelette",
                rice: "Rice",
                borghol: "Borghol",
                normalSalad: "Normal Salad",
                saladeSautee: "Saut√©ed Salad",
                perUnit: "per unit",
                piece: "piece",
                perPortion: "per portion",
                perPortion: "per portion",
                protein: "Protein",
                carbs: "Carbs",
                calories: "Calories",
                price: "Price",
                proteinLabel: "Protein",
                carbsLabel: "Carbs",
                caloriesLabel: "Calories",
                priceLabel: "Price",
                totalPrice: "Total Price",
                itemsInMeal: "items in your meal",
                nutritionalDetails: "Nutritional Details",
                carbohydrates: "Carbohydrates",
                fats: "Fats",
                fiber: "Fiber (from fruit)",
                numberOfMeals: "Number of Meals",
                buyNow: "Buy Now",
                saveMeal: "Save Meal",
                clearAll: "Clear All",
                freeFruit: "Free Daily Surprise Fruit",
                freeFruitDesc: "Every meal comes with a complimentary fresh fruit of the day!",
                todaySurprise: "Today's Surprise: Apple",
                surpriseFruit: "Surprise Fruit",
                dailyFree: "Daily free gift",
                fruitNutrition: "(Approx: 15g Carbs, 80 kcal, Rich in Fiber & Vitamin C)",
                powerBowl: "Power Bowl",
                leanClean: "Lean & Clean",
                highProtein: "HIGH PROTEIN",
                balanced: "BALANCED",
                processing: "Processing...",
                viewMeal: "View Meal",
                maxCarbsAlert: "Maximum 3 carb units allowed per meal!",
                minProteinAlert: "At least 1 protein unit required in your meal!",
                addIngredientsAlert: "Please add ingredients to your meal!",
                addProteinAlert: "Please add at least 1 protein to your meal!",
                confirmOrder: "Confirm your order?",
                clearMealConfirm: "Are you sure you want to clear your meal?",
                mealSavedTitle: "Meal Saved Successfully!",
                mealSavedDesc: "Your meal has been saved!",
                eggs3: "3 eggs",
                customerInfo: "Customer Information",
                yourName: "Your Name",
                yourPhone: "Your Phone Number",
                confirmOrder2: "Confirm Order",
                cancel: "Cancel",
                phoneError: "Phone number must be exactly 8 digits",
                cart: "Cart",
                addToCart: "Add to Cart",
                buyAll: "Buy All",
                emptyCart: "Your cart is empty",
                remove: "√ó",
                total: "Total:"
            },
            fr: {
                headerSubtitle: "Maison Premium de Prot√©ines - Cr√©ez Votre Repas Parfait",
                quickMeals: "Repas Rapides",
                mealScalope: "Repas Escalope",
                mealProteinOverdose: "Surcharge Prot√©ine",
                mealBalanced: "Repas √âquilibr√©",
                buildOwn: "Cr√©ez Votre Propre Repas",
                proteins: "Prot√©ines",
                carbs: "Glucides",
                salads: "Salades",
                escalope: "Escalope",
                cuisse: "Cuisse de Poulet",
                eggs: "≈íufs",
                omelette: "Omelette",
                rice: "Riz",
                borghol: "Borghol",
                normalSalad: "Salade Normale",
                saladeSautee: "Salade Saut√©e",
                perUnit: "par unit√©",
                piece: "pi√®ce",
                perPortion: "par portion",
                perPortion: "par portion",
                protein: "Prot√©ine",
                carbs: "Glucides",
                calories: "Calories",
                price: "Prix",
                proteinLabel: "Prot√©ine",
                carbsLabel: "Glucides",
                caloriesLabel: "Calories",
                priceLabel: "Prix",
                totalPrice: "Prix Total",
                itemsInMeal: "articles dans votre repas",
                nutritionalDetails: "D√©tails Nutritionnels",
                carbohydrates: "Glucides",
                fats: "Lipides",
                fiber: "Fibres (des fruits)",
                numberOfMeals: "Nombre de Repas",
                buyNow: "Acheter",
                saveMeal: "Sauvegarder",
                clearAll: "Tout Effacer",
                freeFruit: "Fruit Surprise Quotidien Gratuit",
                freeFruitDesc: "Chaque repas comprend un fruit frais du jour gratuit!",
                todaySurprise: "Surprise d'aujourd'hui: Pomme",
                surpriseFruit: "Fruit Surprise",
                dailyFree: "Cadeau gratuit quotidien",
                fruitNutrition: "(Environ: 15g Glucides, 80 kcal, Riche en Fibres et Vitamine C)",
                powerBowl: "Bol Puissance",
                leanClean: "L√©ger & Propre",
                highProtein: "HAUTE PROT√âINE",
                balanced: "√âQUILIBR√â",
                processing: "Traitement...",
                viewMeal: "Voir le Repas",
                maxCarbsAlert: "Maximum 3 unit√©s de glucides autoris√©es par repas!",
                minProteinAlert: "Au moins 1 unit√© de prot√©ine requise dans votre repas!",
                addIngredientsAlert: "Veuillez ajouter des ingr√©dients √† votre repas!",
                addProteinAlert: "Veuillez ajouter au moins 1 prot√©ine √† votre repas!",
                confirmOrder: "Confirmer votre commande?",
                clearMealConfirm: "√ätes-vous s√ªr de vouloir effacer votre repas?",
                mealSavedTitle: "Repas Sauvegard√© avec Succ√®s!",
                mealSavedDesc: "Votre repas a √©t√© sauvegard√©!",
                eggs3: "3 ≈ìufs",
                customerInfo: "Informations Client",
                yourName: "Votre Nom",
                yourPhone: "Votre Num√©ro de T√©l√©phone",
                confirmOrder2: "Confirmer la Commande",
                cancel: "Annuler",
                phoneError: "Le num√©ro de t√©l√©phone doit contenir exactement 8 chiffres",
                cart: "Panier",
                addToCart: "Ajouter au Panier",
                buyAll: "Tout Acheter",
                emptyCart: "Votre panier est vide",
                remove: "√ó",
                total: "Total:"
            },
            ar: {
                headerSubtitle: "ÿ®Ÿäÿ™ ÿßŸÑÿ®ÿ±Ÿàÿ™ŸäŸÜ ÿßŸÑŸÖŸÖÿ™ÿßÿ≤ - ÿßÿµŸÜÿπ Ÿàÿ¨ÿ®ÿ™ŸÉ ÿßŸÑŸÖÿ´ÿßŸÑŸäÿ©",
                quickMeals: "Ÿàÿ¨ÿ®ÿßÿ™ ÿ≥ÿ±Ÿäÿπÿ©",
                mealScalope: "Ÿàÿ¨ÿ®ÿ© ÿ•ÿ≥ŸÉÿßŸÑŸàÿ®",
                mealProteinOverdose: "Ÿàÿ¨ÿ®ÿ© ÿ®ÿ±Ÿàÿ™ŸäŸÜ ÿπÿßŸÑŸäÿ©",
                mealBalanced: "Ÿàÿ¨ÿ®ÿ© ŸÖÿ™Ÿàÿßÿ≤ŸÜÿ©",
                buildOwn: "ÿßÿµŸÜÿπ Ÿàÿ¨ÿ®ÿ™ŸÉ ÿßŸÑÿÆÿßÿµÿ©",
                proteins: "ÿßŸÑÿ®ÿ±Ÿàÿ™ŸäŸÜÿßÿ™",
                carbs: "ÿßŸÑŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™",
                salads: "ÿßŸÑÿ≥ŸÑÿ∑ÿßÿ™",
                escalope: "ÿ•ÿ≥ŸÉÿßŸÑŸàÿ®",
                cuisse: "ŸÅÿÆÿ∞ ÿØÿ¨ÿßÿ¨",
                eggs: "ÿ®Ÿäÿ∂",
                omelette: "ÿ£ŸàŸÖŸÑŸäÿ™",
                rice: "ÿ£ÿ±ÿ≤",
                borghol: "ÿ®ÿ±ÿ∫ŸÑ",
                normalSalad: "ÿ≥ŸÑÿ∑ÿ© ÿπÿßÿØŸäÿ©",
                saladeSautee: "ÿ≥ŸÑÿ∑ÿ© ŸÖŸÇŸÑŸäÿ©",
                perUnit: "ŸÑŸÉŸÑ Ÿàÿ≠ÿØÿ©",
                piece: "ŸÇÿ∑ÿπÿ©",
                perPortion: "ŸÑŸÉŸÑ ÿ≠ÿµÿ©",
                perPortion: "ŸÑŸÉŸÑ ÿ≠ÿµÿ©",
                protein: "ÿ®ÿ±Ÿàÿ™ŸäŸÜ",
                carbs: "ŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™",
                calories: "ÿ≥ÿπÿ±ÿßÿ™",
                price: "ÿßŸÑÿ≥ÿπÿ±",
                proteinLabel: "ÿ®ÿ±Ÿàÿ™ŸäŸÜ",
                carbsLabel: "ŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™",
                caloriesLabel: "ÿ≥ÿπÿ±ÿßÿ™",
                priceLabel: "ÿßŸÑÿ≥ÿπÿ±",
                totalPrice: "ÿßŸÑÿ≥ÿπÿ± ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä",
                itemsInMeal: "ÿπŸÜÿµÿ± ŸÅŸä Ÿàÿ¨ÿ®ÿ™ŸÉ",
                nutritionalDetails: "ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ∫ÿ∞ÿßÿ¶Ÿäÿ©",
                carbohydrates: "ÿßŸÑŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™",
                fats: "ÿßŸÑÿØŸáŸàŸÜ",
                fiber: "ÿßŸÑÿ£ŸÑŸäÿßŸÅ (ŸÖŸÜ ÿßŸÑŸÅŸàÿßŸÉŸá)",
                numberOfMeals: "ÿπÿØÿØ ÿßŸÑŸàÿ¨ÿ®ÿßÿ™",
                buyNow: "ÿßÿ¥ÿ™ÿ±Ÿä ÿßŸÑÿ¢ŸÜ",
                saveMeal: "ÿßÿ≠ŸÅÿ∏ ÿßŸÑŸàÿ¨ÿ®ÿ©",
                clearAll: "ŸÖÿ≥ÿ≠ ÿßŸÑŸÉŸÑ",
                freeFruit: "ŸÅÿßŸÉŸáÿ© ŸÖŸÅÿßÿ¨ÿ£ÿ© ŸäŸàŸÖŸäÿ© ŸÖÿ¨ÿßŸÜŸäÿ©",
                freeFruitDesc: "ŸÉŸÑ Ÿàÿ¨ÿ®ÿ© ÿ™ÿ£ÿ™Ÿä ŸÖÿπ ŸÅÿßŸÉŸáÿ© ÿ∑ÿßÿ≤ÿ¨ÿ© ŸÖÿ¨ÿßŸÜŸäÿ©!",
                todaySurprise: "ŸÖŸÅÿßÿ¨ÿ£ÿ© ÿßŸÑŸäŸàŸÖ: ÿ™ŸÅÿßÿ≠ÿ©",
                surpriseFruit: "ŸÅÿßŸÉŸáÿ© ŸÖŸÅÿßÿ¨ÿ£ÿ©",
                dailyFree: "ŸáÿØŸäÿ© ŸÖÿ¨ÿßŸÜŸäÿ© ŸäŸàŸÖŸäÿ©",
                fruitNutrition: "(ÿ™ŸÇÿ±Ÿäÿ®ÿßŸã: 15 ÿ¨ŸÖ ŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™ÿå 80 ÿ≥ÿπÿ±ÿ©ÿå ÿ∫ŸÜŸä ÿ®ÿßŸÑÿ£ŸÑŸäÿßŸÅ ŸàŸÅŸäÿ™ÿßŸÖŸäŸÜ C)",
                powerBowl: "Ÿàÿ¨ÿ®ÿ© ÿßŸÑŸÇŸàÿ©",
                leanClean: "ÿÆŸÅŸäŸÅ ŸàŸÜÿ∏ŸäŸÅ",
                highProtein: "ÿ®ÿ±Ÿàÿ™ŸäŸÜ ÿπÿßŸÑŸä",
                balanced: "ŸÖÿ™Ÿàÿßÿ≤ŸÜ",
                processing: "ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...",
                viewMeal: "ÿπÿ±ÿ∂ ÿßŸÑŸàÿ¨ÿ®ÿ©",
                maxCarbsAlert: "ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ 3 Ÿàÿ≠ÿØÿßÿ™ ŸÉÿ±ÿ®ŸàŸáŸäÿØÿ±ÿßÿ™ ŸÑŸÉŸÑ Ÿàÿ¨ÿ®ÿ©!",
                minProteinAlert: "ŸÖÿ∑ŸÑŸàÿ® Ÿàÿ≠ÿØÿ© ÿ®ÿ±Ÿàÿ™ŸäŸÜ Ÿàÿßÿ≠ÿØÿ© ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ ŸÅŸä Ÿàÿ¨ÿ®ÿ™ŸÉ!",
                addIngredientsAlert: "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÉŸàŸÜÿßÿ™ ÿ•ŸÑŸâ Ÿàÿ¨ÿ®ÿ™ŸÉ!",
                addProteinAlert: "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿ∂ÿßŸÅÿ© ÿ®ÿ±Ÿàÿ™ŸäŸÜ Ÿàÿßÿ≠ÿØ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ ÿ•ŸÑŸâ Ÿàÿ¨ÿ®ÿ™ŸÉ!",
                confirmOrder: "ÿ™ÿ£ŸÉŸäÿØ ÿ∑ŸÑÿ®ŸÉÿü",
                clearMealConfirm: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ŸÖÿ≥ÿ≠ Ÿàÿ¨ÿ®ÿ™ŸÉÿü",
                mealSavedTitle: "ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑŸàÿ¨ÿ®ÿ© ÿ®ŸÜÿ¨ÿßÿ≠!",
                mealSavedDesc: "ÿ™ŸÖ ÿ≠ŸÅÿ∏ Ÿàÿ¨ÿ®ÿ™ŸÉ!",
                eggs3: "3 ÿ®Ÿäÿ∂ÿßÿ™",
                customerInfo: "ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ",
                yourName: "ÿßÿ≥ŸÖŸÉ",
                yourPhone: "ÿ±ŸÇŸÖ Ÿáÿßÿ™ŸÅŸÉ",
                confirmOrder2: "ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®",
                cancel: "ÿ•ŸÑÿ∫ÿßÿ°",
                phoneError: "Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ 8 ÿ£ÿ±ŸÇÿßŸÖ ÿ®ÿßŸÑÿ∂ÿ®ÿ∑",
                cart: "ÿßŸÑÿ≥ŸÑÿ©",
                addToCart: "ÿ£ÿ∂ŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©",
                buyAll: "ÿßÿ¥ÿ™ÿ±Ÿä ÿßŸÑŸÉŸÑ",
                emptyCart: "ÿ≥ŸÑÿ™ŸÉ ŸÅÿßÿ±ÿ∫ÿ©",
                remove: "√ó",
                total: "ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä:"
            }
        };

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('preferredLanguage', lang);
            
            // Update active language button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('lang-' + lang).classList.add('active');
            
            // Apply translations
            const t = translations[lang];
            
            document.getElementById('header-subtitle').textContent = t.headerSubtitle;
            document.querySelector('[data-translate="quickMeals"]').textContent = 'üéØ ' + t.quickMeals;
            document.querySelector('[data-translate="buildOwn"]').textContent = 'üî® ' + t.buildOwn;
            document.querySelector('[data-translate="proteins"]').textContent = 'üçñ ' + t.proteins;
            document.querySelector('[data-translate="carbs"]').textContent = 'üçö ' + t.carbs;
            document.querySelector('[data-translate="salads"]').textContent = 'ü•ó ' + t.salads;
            
            // Update meal summary
            document.querySelector('[data-translate="totalPrice"]').textContent = t.totalPrice;
            document.querySelector('[data-translate="protein"]').textContent = 'üí™ ' + t.protein;
            document.querySelector('[data-translate="calories"]').textContent = 'üî• ' + t.calories;
            document.querySelector('[data-translate="nutritionalDetails"]').textContent = t.nutritionalDetails;
            document.querySelector('[data-translate="carbohydrates"]').textContent = t.carbohydrates;
            document.querySelector('[data-translate="fats"]').textContent = t.fats;
            document.querySelector('[data-translate="fiber"]').textContent = t.fiber;
            document.querySelector('[data-translate="numberOfMeals"]').textContent = t.numberOfMeals;
            
            // Update buttons
            document.querySelector('[data-translate="buyNow"]').innerHTML = 'üõí ' + t.buyNow;
            document.querySelector('[data-translate="saveMeal"]').innerHTML = 'üíæ ' + t.saveMeal;
            document.querySelector('[data-translate="clearAll"]').innerHTML = 'üóëÔ∏è ' + t.clearAll;
            document.querySelector('[data-translate="viewMeal"]').textContent = t.viewMeal;
            
            // Update free fruit section
            const freeFruitEl = document.querySelector('[data-translate="freeFruit"]');
            if (freeFruitEl) freeFruitEl.textContent = t.freeFruit;
            const surpriseFruitEl = document.querySelector('[data-translate="surpriseFruit"]');
            if (surpriseFruitEl) surpriseFruitEl.textContent = t.surpriseFruit;
            const dailyFreeEl = document.querySelector('[data-translate="dailyFree"]');
            if (dailyFreeEl) dailyFreeEl.textContent = t.dailyFree;
            
            // Update ingredient names
            document.querySelector('[data-ingredient="escalope"]').textContent = t.escalope;
            document.querySelector('[data-ingredient="cuisse"]').textContent = t.cuisse;
            document.querySelector('[data-ingredient="eggs"]').textContent = t.eggs;
            document.querySelector('[data-ingredient="omelette"]').textContent = t.omelette;
            document.querySelector('[data-ingredient="rice"]').textContent = t.rice;
            document.querySelector('[data-ingredient="borghol"]').textContent = t.borghol;
            document.querySelector('[data-ingredient="normalSalad"]').textContent = t.normalSalad;
            
            // Update unit labels
            document.querySelectorAll('[data-translate="perUnit"]').forEach(el => el.textContent = t.perUnit);
            document.querySelectorAll('[data-translate="piece"]').forEach(el => el.textContent = t.piece);
            document.querySelectorAll('[data-translate="perPortion"]').forEach(el => el.textContent = t.perPortion);
            document.querySelectorAll('[data-translate="eggs3"]').forEach(el => el.textContent = t.eggs3);
            
            // Update nutrition labels
            document.querySelectorAll('[data-translate="proteinLabel"]').forEach(el => el.textContent = t.proteinLabel);
            document.querySelectorAll('[data-translate="carbsLabel"]').forEach(el => el.textContent = t.carbsLabel);
            document.querySelectorAll('[data-translate="caloriesLabel"]').forEach(el => el.textContent = t.caloriesLabel);
            document.querySelectorAll('[data-translate="priceLabel"]').forEach(el => el.textContent = t.priceLabel);
            
            // Update meal tags and titles
            const highProteinEl = document.querySelector('[data-translate="highProtein"]');
            if (highProteinEl) highProteinEl.textContent = t.highProtein;
            const balancedEl = document.querySelector('[data-translate="balanced"]');
            if (balancedEl) balancedEl.textContent = t.balanced;
            const powerBowlEl = document.querySelector('[data-translate="powerBowl"]');
            if (powerBowlEl) powerBowlEl.textContent = t.powerBowl;
            const leanCleanEl = document.querySelector('[data-translate="leanClean"]');
            if (leanCleanEl) leanCleanEl.textContent = t.leanClean;
            
            // Update quick meal names
            const mealScalopeEl = document.querySelector('[data-translate="mealScalope"]');
            if (mealScalopeEl) mealScalopeEl.textContent = t.mealScalope;
            const mealProteinOverdoseEl = document.querySelector('[data-translate="mealProteinOverdose"]');
            if (mealProteinOverdoseEl) mealProteinOverdoseEl.textContent = t.mealProteinOverdose;
            const mealBalancedEl = document.querySelector('[data-translate="mealBalanced"]');
            if (mealBalancedEl) mealBalancedEl.textContent = t.mealBalanced;
            
            // Update customer info modal
            const customerInfoEl = document.querySelector('[data-translate="customerInfo"]');
            if (customerInfoEl) customerInfoEl.textContent = t.customerInfo;
            const yourNameEl = document.querySelector('[data-translate="yourName"]');
            if (yourNameEl) yourNameEl.textContent = t.yourName;
            const yourPhoneEl = document.querySelector('[data-translate="yourPhone"]');
            if (yourPhoneEl) yourPhoneEl.textContent = t.yourPhone;
            const confirmOrder2El = document.querySelector('[data-translate="confirmOrder2"]');
            if (confirmOrder2El) confirmOrder2El.textContent = t.confirmOrder2;
            const cancelEl = document.querySelector('[data-translate="cancel"]');
            if (cancelEl) cancelEl.textContent = t.cancel;
            const phoneErrorEl = document.querySelector('[data-translate="phoneError"]');
            if (phoneErrorEl) phoneErrorEl.textContent = t.phoneError;
            
            // Update cart translations
            const cartEl = document.querySelector('[data-translate="cart"]');
            if (cartEl) cartEl.textContent = t.cart;
            const addToCartEl = document.querySelector('[data-translate="addToCart"]');
            if (addToCartEl) addToCartEl.textContent = '‚ûï ' + t.addToCart;
            const buyAllEl = document.querySelector('[data-translate="buyAll"]');
            if (buyAllEl) buyAllEl.textContent = 'üõí ' + t.buyAll;
            const emptyCartEl = document.querySelector('[data-translate="emptyCart"]');
            if (emptyCartEl) emptyCartEl.textContent = t.emptyCart;
            const totalEl = document.querySelector('[data-translate="total"]');
            if (totalEl) totalEl.textContent = t.total;
            const removeEls = document.querySelectorAll('[data-translate="remove"]');
            removeEls.forEach(el => el.textContent = t.remove);
            
            // Update item count
            updateItemCount();
            
            // Update cart display if cart exists
            if (cart.length > 0) {
                updateCartDisplay();
            }
            
            // Set text direction
            document.body.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        }

        const ingredients = {
            rice: { 
                qty: 0, 
                protein: 3, 
                carbs: 40, 
                fat: 0.5, 
                calories: 175, 
                price: 1.50,
                emoji: 'üçö'
            },
            borghol: { 
                qty: 0, 
                protein: 4, 
                carbs: 38, 
                fat: 0.8, 
                calories: 170, 
                price: 1.50,
                emoji: 'üçõ'
            },
            scallop: { 
                qty: 0, 
                protein: 25, 
                carbs: 0, 
                fat: 2, 
                calories: 120, 
                price: 8.50,
                emoji: 'ü•©'
            },
            cuisse: { 
                qty: 0, 
                protein: 18, 
                carbs: 0, 
                fat: 10, 
                calories: 160, 
                price: 3.50,
                emoji: 'üçó'
            },
            eggs: { 
                qty: 0, 
                protein: 6, 
                carbs: 1, 
                fat: 5, 
                calories: 70, 
                price: 0.80,
                emoji: 'üç≥'
            },
            omelette: { 
                qty: 0, 
                protein: 15, 
                carbs: 2, 
                fat: 12, 
                calories: 180, 
                price: 2.50,
                emoji: 'ü•ö'
            },
            salad: { 
                qty: 0, 
                protein: 1, 
                carbs: 5, 
                fat: 0.5, 
                calories: 25, 
                price: 1.50,
                emoji: 'ü•¨'
            },
            frite: { 
                qty: 0, 
                protein: 2, 
                carbs: 8, 
                fat: 3, 
                calories: 65, 
                price: 1.50,
                emoji: 'ü•ò'
            }
        };

        function updateIngredient(type, change) {
            const newQty = Math.max(0, ingredients[type].qty + change);
            const t = translations[currentLanguage];
            
            // Validation: Max 3 carb units
            if ((type === 'rice' || type === 'borghol') && change > 0) {
                const totalCarbs = ingredients.rice.qty + ingredients.borghol.qty;
                if (totalCarbs >= 3) {
                    alert('‚ö†Ô∏è ' + t.maxCarbsAlert);
                    return;
                }
            }
            
            // Validation: Minimum 1 protein unit (prevent removing last protein)
            if ((type === 'scallop' || type === 'cuisse' || type === 'eggs' || type === 'omelette') && change < 0) {
                const totalProteins = ingredients.scallop.qty + ingredients.cuisse.qty + ingredients.eggs.qty + ingredients.omelette.qty;
                if (totalProteins === 1 && ingredients[type].qty === 1) {
                    alert('‚ö†Ô∏è ' + t.minProteinAlert);
                    return;
                }
            }
            
            ingredients[type].qty = newQty;
            document.getElementById(`qty-${type}`).textContent = ingredients[type].qty;
            
            // Add color feedback to button
            if (change > 0) {
                event.target.classList.add('add-feedback');
                setTimeout(() => event.target.classList.remove('add-feedback'), 400);
            } else if (change < 0) {
                event.target.classList.add('remove-feedback');
                setTimeout(() => event.target.classList.remove('remove-feedback'), 400);
            }
            
            // Highlight the ingredient card for visual feedback
            const card = document.getElementById(`qty-${type}`).closest('.ingredient-card');
            if (card) {
                card.classList.add('highlight');
                setTimeout(() => card.classList.remove('highlight'), 500);
            }
            
            updateTotals();
            animateMeal();
            updateItemCount();
            updateButtonStates();
        }

        function changeMealCount(change) {
            const mealCountInput = document.getElementById('mealCount');
            const currentValue = parseInt(mealCountInput.value) || 1;
            const newValue = Math.max(1, Math.min(7, currentValue + change));
            
            mealCountInput.value = newValue;
            document.getElementById('mealCountDisplay').textContent = newValue;
            
            // Update button states
            document.getElementById('mealCountDecrease').disabled = newValue <= 1;
            document.getElementById('mealCountIncrease').disabled = newValue >= 7;
            
            // Add visual feedback
            const btn = change > 0 ? document.getElementById('mealCountIncrease') : document.getElementById('mealCountDecrease');
            btn.classList.add('add-feedback');
            setTimeout(() => btn.classList.remove('add-feedback'), 300);
            
            updateTotals();
        }

        function updateTotals() {
            let totalProtein = 0;
            let totalCarbs = 15; // Including free fruit
            let totalFats = 0;
            let totalCalories = 80; // Including free fruit
            let totalPrice = 0;
            let totalWeight = 0;

            for (let key in ingredients) {
                const ing = ingredients[key];
                totalProtein += ing.protein * ing.qty;
                totalCarbs += ing.carbs * ing.qty;
                totalFats += ing.fat * ing.qty;
                totalCalories += ing.calories * ing.qty;
                totalPrice += ing.price * ing.qty;
                
                // Calculate weight
                if (key === 'rice' || key === 'borghol') totalWeight += 50 * ing.qty;
                else if (key === 'scallop') totalWeight += 100 * ing.qty;
                else if (key === 'cuisse') totalWeight += 150 * ing.qty;
                else if (key === 'eggs') totalWeight += 50 * ing.qty;
                else if (key === 'omelette') totalWeight += 150 * ing.qty;
                else if (key === 'salad' || key === 'frite') totalWeight += 100 * ing.qty;
            }

            // Price is per meal, not multiplied by quantity
            document.getElementById('totalProtein').textContent = totalProtein.toFixed(0);
            document.getElementById('totalCarbs').textContent = totalCarbs.toFixed(0);
            document.getElementById('totalFats').textContent = totalFats.toFixed(1);
            document.getElementById('totalCalories').textContent = totalCalories.toFixed(0);
            document.getElementById('totalPrice').textContent = totalPrice.toFixed(2);

            // Update mobile bar
            document.getElementById('mobileTotalPrice').textContent = totalPrice.toFixed(2);
            document.getElementById('mobileTotalProtein').textContent = totalProtein.toFixed(0);

            // Store for progress bars
            window.currentTotals = {
                protein: totalProtein,
                calories: totalCalories,
                weight: totalWeight
            };
        }

        function updateItemCount() {
            let totalItems = 0;
            for (let key in ingredients) {
                totalItems += ingredients[key].qty;
            }
            
            const t = translations[currentLanguage];
            const countElement = document.getElementById('itemsCount');
            countElement.innerHTML = `<strong>${totalItems}</strong> ${t.itemsInMeal}`;
        }

        function updateButtonStates() {
            const hasItems = Object.values(ingredients).some(ing => ing.qty > 0);
            const totalProteins = ingredients.scallop.qty + ingredients.cuisse.qty + ingredients.eggs.qty + ingredients.omelette.qty;
            const hasMinProtein = totalProteins >= 1;
            
            // Enable buttons only if meal has items AND at least 1 protein
            const canOrder = hasItems && hasMinProtein;
            document.getElementById('addToCartBtn').disabled = !canOrder;
            document.getElementById('saveBtn').disabled = !canOrder;
        }

        let cart = [];

        function addToCart() {
            const t = translations[currentLanguage];
            const totalProteins = ingredients.scallop.qty + ingredients.cuisse.qty + ingredients.eggs.qty + ingredients.omelette.qty;
            if (totalProteins === 0) {
                alert('‚ö†Ô∏è ' + t.addProteinAlert);
                return;
            }

            const mealCount = parseInt(document.getElementById('mealCount').value) || 1;
            const mealDescription = getMealDescription();
            const totalPrice = parseFloat(document.getElementById('totalPrice').textContent);
            const protein = document.getElementById('totalProtein').textContent;
            const calories = document.getElementById('totalCalories').textContent;
            const carbs = document.getElementById('totalCarbs').textContent;
            const fats = document.getElementById('totalFats').textContent;

            // Create meal object
            const meal = {
                id: Date.now(),
                description: mealDescription,
                ingredients: JSON.parse(JSON.stringify(ingredients)),
                quantity: mealCount,
                price: totalPrice,
                protein: protein,
                calories: calories,
                carbs: carbs,
                fats: fats
            };

            cart.push(meal);
            updateCartDisplay();
            clearMeal();
            
            // Show cart section
            document.getElementById('cartSection').style.display = 'block';
        }

        function updateCartDisplay() {
            const cartItemsEl = document.getElementById('cartItems');
            const cartBadgeEl = document.getElementById('cartBadge');
            const cartTotalEl = document.getElementById('cartTotal');
            const buyAllBtn = document.getElementById('buyAllBtn');
            const t = translations[currentLanguage];

            cartBadgeEl.textContent = cart.length;
            
            if (cart.length === 0) {
                cartItemsEl.innerHTML = `<div class="empty-cart" data-translate="emptyCart">${t.emptyCart}</div>`;
                document.getElementById('cartSection').style.display = 'none';
                buyAllBtn.disabled = true;
                return;
            }

            let totalPrice = 0;
            let html = '';

            cart.forEach((item, index) => {
                totalPrice += item.price * item.quantity;
                html += `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.description}</div>
                            <div class="cart-item-details">${item.protein}g ${t.proteinLabel} ‚Ä¢ ${item.calories} ${t.caloriesLabel} ‚Ä¢ ${t.numberOfMeals}: ${item.quantity}</div>
                        </div>
                        <div class="cart-item-controls">
                            <button class="control-btn" onclick="updateCartItem(${index}, -1)" style="width: 35px; height: 35px; font-size: 1.2em;">‚àí</button>
                            <div class="quantity-display" style="min-width: 30px;">${item.quantity}</div>
                            <button class="control-btn" onclick="updateCartItem(${index}, 1)" style="width: 35px; height: 35px; font-size: 1.2em;">+</button>
                            <div class="cart-item-price">${(item.price * item.quantity).toFixed(2)} TND</div>
                            <button class="cart-remove-btn" onclick="removeFromCart(${index})" data-translate="remove">√ó</button>
                        </div>
                    </div>
                `;
            });

            cartItemsEl.innerHTML = html;
            cartTotalEl.textContent = totalPrice.toFixed(2) + ' TND';
            buyAllBtn.disabled = false;
        }

        function updateCartItem(index, change) {
            if (index < 0 || index >= cart.length) return;
            
            cart[index].quantity = Math.max(1, Math.min(7, cart[index].quantity + change));
            updateCartDisplay();
        }

        function removeFromCart(index) {
            if (index < 0 || index >= cart.length) return;
            cart.splice(index, 1);
            updateCartDisplay();
        }

        function buyAllFromCart() {
            const t = translations[currentLanguage];
            if (cart.length === 0) {
                alert(t.addIngredientsAlert);
                return;
            }

            // Show customer info modal
            document.getElementById('customerInfoModal').classList.add('active');
            document.getElementById('customerName').focus();
        }

        function clearMeal() {
            if (!Object.values(ingredients).some(ing => ing.qty > 0)) {
                return;
            }

            const t = translations[currentLanguage];
            if (confirm(t.clearMealConfirm)) {
                for (let key in ingredients) {
                    ingredients[key].qty = 0;
                    document.getElementById(`qty-${key}`).textContent = 0;
                }
                updateTotals();
                animateMeal();
                updateItemCount();
                updateButtonStates();
            }
        }

        function updateProgressBars() {
            if (!window.currentTotals) return;

            // Protein progress (target: 100g for a complete meal)
            const proteinPercent = Math.min((window.currentTotals.protein / 100) * 100, 100);
            document.getElementById('proteinBar').style.width = proteinPercent + '%';
            document.getElementById('proteinPercent').textContent = Math.round(proteinPercent) + '%';

            // Calorie progress (target: 800 kcal for a complete meal)
            const caloriePercent = Math.min((window.currentTotals.calories / 800) * 100, 100);
            document.getElementById('calorieBar').style.width = caloriePercent + '%';
            document.getElementById('caloriePercent').textContent = Math.round(caloriePercent) + '%';

            // Weight progress (shows actual weight)
            const weightPercent = Math.min((window.currentTotals.weight / 500) * 100, 100);
            document.getElementById('weightBar').style.width = weightPercent + '%';
            document.getElementById('weightAmount').textContent = window.currentTotals.weight + 'g';
        }

        function scrollToSummary() {
            document.querySelector('.meal-summary').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function animateMeal() {
            const mealPhoto = document.getElementById('mealEmoji');
            
            // Clear current content
            mealPhoto.innerHTML = '';
            
            // Check if meal is empty
            let isEmpty = true;
            for (let key in ingredients) {
                if (ingredients[key].qty > 0) {
                    isEmpty = false;
                    break;
                }
            }

            // Show placeholder if empty
            if (isEmpty) {
                const emptyContainer = document.createElement('div');
                emptyContainer.style.textAlign = 'center';
                
                const placeholder = document.createElement('div');
                placeholder.className = 'empty-meal-placeholder';
                placeholder.textContent = 'üçΩÔ∏è';
                emptyContainer.appendChild(placeholder);
                
                const message = document.createElement('div');
                message.style.color = '#999';
                message.style.fontSize = '0.9em';
                message.style.marginTop = '10px';
                message.textContent = 'Add ingredients to build your meal';
                emptyContainer.appendChild(message);
                
                mealPhoto.appendChild(emptyContainer);
                return;
            }

            // Add ingredients in realistic plating order: rice base, then proteins, then vegetables
            const platingOrder = ['rice', 'borghol', 'scallop', 'cuisse', 'eggs', 'omelette', 'salad', 'frite'];
            
            for (let key of platingOrder) {
                const ing = ingredients[key];
                for (let i = 0; i < ing.qty; i++) {
                    const icon = document.createElement('div');
                    icon.className = 'meal-ingredient-icon';
                    icon.textContent = ing.emoji;
                    icon.title = key.charAt(0).toUpperCase() + key.slice(1);
                    mealPhoto.appendChild(icon);
                }
            }

            // Add free surprise fruit icon at the end
            if (!isEmpty) {
                const fruitIcon = document.createElement('div');
                fruitIcon.className = 'meal-ingredient-icon';
                fruitIcon.textContent = 'üéÅ';
                fruitIcon.title = 'Free Surprise Fruit';
                fruitIcon.style.fontSize = '0.8em';
                mealPhoto.appendChild(fruitIcon);
            }
        }

        function selectQuickMeal(type) {
            // Reset all
            for (let key in ingredients) {
                ingredients[key].qty = 0;
                document.getElementById(`qty-${key}`).textContent = 0;
            }

            if (type === 'scalope') {
                // 100g rice (2 units) + 100g escalope (1 unit) + 1 salad
                ingredients.rice.qty = 2;
                ingredients.scallop.qty = 1;
                ingredients.salad.qty = 1;
            } else if (type === 'proteinOverdose') {
                // 100g escalope (1 unit) + 1 cuisse + 1 egg + 1 omelette + 1 salad
                ingredients.scallop.qty = 1;
                ingredients.cuisse.qty = 1;
                ingredients.eggs.qty = 1;
                ingredients.omelette.qty = 1;
                ingredients.salad.qty = 1;
            } else if (type === 'balanced') {
                // 100g rice (2 units) + 100g escalope (1 unit) + 2 eggs + 1 salad
                ingredients.rice.qty = 2;
                ingredients.scallop.qty = 1;
                ingredients.eggs.qty = 2;
                ingredients.salad.qty = 1;
            }

            for (let key in ingredients) {
                document.getElementById(`qty-${key}`).textContent = ingredients[key].qty;
            }

            updateTotals();
            animateMeal();
            updateItemCount();
            updateButtonStates();

            // Automatically add to cart
            const mealCount = parseInt(document.getElementById('mealCount').value) || 1;
            const mealDescription = getMealDescription();
            const totalPrice = parseFloat(document.getElementById('totalPrice').textContent);
            const protein = document.getElementById('totalProtein').textContent;
            const calories = document.getElementById('totalCalories').textContent;
            const carbs = document.getElementById('totalCarbs').textContent;
            const fats = document.getElementById('totalFats').textContent;

            // Create meal object and add to cart
            const meal = {
                id: Date.now(),
                description: mealDescription,
                ingredients: JSON.parse(JSON.stringify(ingredients)),
                quantity: mealCount,
                price: totalPrice,
                protein: protein,
                calories: calories,
                carbs: carbs,
                fats: fats
            };

            cart.push(meal);
            updateCartDisplay();
            clearMeal();
            
            // Show cart section
            document.getElementById('cartSection').style.display = 'block';

            // Scroll to cart on mobile
            if (window.innerWidth < 1200) {
                setTimeout(() => {
                    document.getElementById('cartSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 300);
            }
        }

        function selectDefaultMeal(type) {
            // Reset all
            for (let key in ingredients) {
                ingredients[key].qty = 0;
                document.getElementById(`qty-${key}`).textContent = 0;
            }

            if (type === 'power') {
                ingredients.rice.qty = 3;
                ingredients.scallop.qty = 2;
                ingredients.cuisse.qty = 2;
                ingredients.salad.qty = 1;
            } else if (type === 'lean') {
                ingredients.rice.qty = 2;
                ingredients.scallop.qty = 1;
                ingredients.eggs.qty = 3;
                ingredients.salad.qty = 2;
            }

            for (let key in ingredients) {
                document.getElementById(`qty-${key}`).textContent = ingredients[key].qty;
            }

            updateTotals();
            animateMeal();
            updateItemCount();
            updateButtonStates();

            // Scroll to summary on mobile
            if (window.innerWidth < 1200) {
                setTimeout(() => {
                    document.querySelector('.meal-summary').scrollIntoView({ behavior: 'smooth' });
                }, 300);
            }
        }

        function getMealDescription() {
            let items = [];
            for (let key in ingredients) {
                if (ingredients[key].qty > 0) {
                    items.push(`${key}: ${ingredients[key].qty}`);
                }
            }
            return items.join(', ');
        }

        function closeCustomerModal() {
            document.getElementById('customerInfoModal').classList.remove('active');
            document.getElementById('customerForm').reset();
            document.getElementById('phoneError').style.display = 'none';
            document.getElementById('customerPhone').style.borderColor = '#e0e0e0';
        }

        function validatePhone(input) {
            const phone = input.value.replace(/\D/g, ''); // Remove non-digits
            input.value = phone; // Update input with only digits
            
            const errorEl = document.getElementById('phoneError');
            const t = translations[currentLanguage];
            
            if (phone.length === 8) {
                errorEl.style.display = 'none';
                input.style.borderColor = '#22c55e';
            } else if (phone.length > 0) {
                errorEl.style.display = 'block';
                errorEl.textContent = t.phoneError;
                input.style.borderColor = '#ef4444';
            } else {
                errorEl.style.display = 'none';
                input.style.borderColor = '#e0e0e0';
            }
        }

        function toggleNutrition(icon) {
            const card = icon.closest('.ingredient-card');
            const nutritionSection = card.querySelector('.ingredient-nutrition-compact');
            nutritionSection.classList.toggle('show');
        }

        function setDailySurpriseFruit() {
            const fruits = ['üçé', 'üçå', 'üçä', 'üçá', 'üçì', 'ü•ù', 'üçë'];
            const dayOfWeek = new Date().getDay(); // 0 = Sunday, 1 = Monday, etc.
            const fruitIcon = document.getElementById('surpriseFruitIcon');
            if (fruitIcon) {
                fruitIcon.textContent = fruits[dayOfWeek];
            }
        }

        function submitOrder(event) {
            event.preventDefault();
            
            const t = translations[currentLanguage];
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.replace(/\D/g, '');
            const phoneErrorEl = document.getElementById('phoneError');
            
            // Validate phone number
            if (customerPhone.length !== 8) {
                phoneErrorEl.style.display = 'block';
                phoneErrorEl.textContent = t.phoneError;
                document.getElementById('customerPhone').style.borderColor = '#ef4444';
                document.getElementById('customerPhone').focus();
                return;
            }

            // Close modal
            closeCustomerModal();

            // Calculate totals from cart
            let totalPrice = 0;
            let totalProtein = 0;
            let totalCalories = 0;
            let totalCarbs = 0;
            let totalFats = 0;
            let mealsList = [];

            cart.forEach((item, index) => {
                totalPrice += item.price * item.quantity;
                totalProtein += parseFloat(item.protein) * item.quantity;
                totalCalories += parseFloat(item.calories) * item.quantity;
                totalCarbs += parseFloat(item.carbs) * item.quantity;
                totalFats += parseFloat(item.fats) * item.quantity;
                mealsList.push(`Meal ${index + 1}: ${item.description} (Qty: ${item.quantity})`);
            });

            // Create form for Basin
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = 'https://usebasin.com/f/b06e024d33ee';
            form.style.display = 'none';

            const fields = {
                'customer_name': customerName,
                'customer_phone': customerPhone,
                'meals': mealsList.join(' | '),
                'total_items': cart.length,
                'total_price': totalPrice.toFixed(2) + ' TND',
                'total_protein': totalProtein.toFixed(0) + 'g',
                'total_calories': totalCalories.toFixed(0) + ' kcal',
                'total_carbs': totalCarbs.toFixed(0) + 'g',
                'total_fats': totalFats.toFixed(1) + 'g'
            };

            for (let key in fields) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = fields[key];
                form.appendChild(input);
            }

            document.body.appendChild(form);
            
            // Clear cart after submission
            cart = [];
            updateCartDisplay();
            
            form.submit();
        }

        function saveMeal() {
            const t = translations[currentLanguage];
            const totalPrice = document.getElementById('totalPrice').textContent;
            
            if (parseFloat(totalPrice) === 0) {
                alert(t.addIngredientsAlert);
                return;
            }

            // Validation: Check minimum protein requirement
            const totalProteins = ingredients.scallop.qty + ingredients.cuisse.qty + ingredients.eggs.qty + ingredients.omelette.qty;
            if (totalProteins === 0) {
                alert('‚ö†Ô∏è ' + t.addProteinAlert);
                return;
            }

            const mealDescription = getMealDescription();
            const mealData = {
                ingredients: JSON.parse(JSON.stringify(ingredients)),
                mealCount: document.getElementById('mealCount').value,
                timestamp: new Date().toISOString()
            };

            try {
                localStorage.setItem('savedMeal_' + Date.now(), JSON.stringify(mealData));
                showModal('üíæ ' + t.mealSavedTitle, `${t.mealSavedDesc}<br><br>${mealDescription}<br>${t.totalPrice}: ${totalPrice} TND`);
            } catch (e) {
                alert('Failed to save meal. Please try again.');
            }
        }

        function showModal(title, message) {
            document.getElementById('modalMessage').innerHTML = `<strong>${title}</strong><br>${message}`;
            document.getElementById('successModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('successModal').classList.remove('active');
        }

        // Initialize
        updateTotals();
        animateMeal();
        updateItemCount();
        updateButtonStates();
        setDailySurpriseFruit();
        
        // Initialize meal count buttons
        const mealCount = parseInt(document.getElementById('mealCount').value) || 1;
        document.getElementById('mealCountDecrease').disabled = mealCount <= 1;
        document.getElementById('mealCountIncrease').disabled = mealCount >= 7;


        // Load saved language preference or default to Arabic
        const savedLang = localStorage.getItem('preferredLanguage') || 'ar';
        changeLanguage(savedLang);
    </script>
</body>
</html>
